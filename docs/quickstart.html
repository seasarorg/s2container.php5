<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"><head>



<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="keywords" content="Seasar2, S2Container, DI, AOP, Dependency Injection, Aspect Oriented Programming, The Seasar Foundation, OSS, オープンソースソフトウェア, Java, フレームワーク">
<meta name="description" content="私たちSeasarプロジェクトはオープンソースという仕組みの元、開発者のゆとりを実現できるプロダクトの開発と提供を通じて、ユーザと開発者とが共に喜びを分かち合える環境実現をお手伝いすることを目指し活動しています。 ">
<title>The Seasar Project - S2Container.PHP5</title>

<link rel="stylesheet" type="text/css" href="theme/main.css" media="screen,projection">
<link rel="stylesheet" type="text/css" href="theme/print.css" media="print"></head><body>

<div id="wrapper">

<div id="header">

<div class="line"><span class="hide">spacer</span></div>

<div id="logo">
<h1 id="h01" class="hide">The Seasar Project</h1>
<a href="http://www.seasar.org/">
<img src="images/seasar_logo_blue.gif" alt="The Seasar Project" height="180" width="390">
</a>
</div>

<div id="tool">
</div>

<div id="navi">
<p><font size="-1"><a href="index.html">S2Container.PHP5 ホーム</a> &raquo; ドキュメント &raquo; クイックスタート</font></p>
</div>

</div><!-- header -->

<div id="contents_left">

<h2>メニュー</h2>

<h3>ドキュメント</h3>
<ul>
    <li><a href="setup.html">セットアップ</a>
    <li>クイックスタート
        <font size="-2">
        <ul>
            <li><a href="#start">はじめに</a></li>
            <li><a href="#container">コンテナの生成</a></li>
            <li><a href="#component">コンポーネントの生成</a></li>
            <li><a href="#get-component">コンポーネントの取得</a></li>
            <li><a href="#many-component">複数のコンポーネントを扱ってみる</a></li>
            <li><a href="#di">DI ( Dependency Injection ) してみる</a></li>
            <li><a href="#aspect">アスペクトしてみる</a></li>
            <li><a href="#autoaspect">自動アスペクト</a></li>
            <li><a href="#dicon">DICON ファイルを使用する場合</a></li>
        </ul>
        </font>
    </li>
    <li><a href="DIContainer.html">DIContainer</a></li>
    <li><a href="aop.html">AOP</a></li>
    <li><a href="extension.html">Extension</a></li>
    <li><a href="php.html">PHP式</a></li>
</ul>

</div><!-- contents_left -->

<div id="contents_center">

<div id="article">
<div class="section">
<h2 id="h02"><a name="start">はじめに</a></h2>
<p>
　はじめに<a href="setup.html">セットアップドキュメント</a>にしたがって S2Container.PHP5-1.2 以降をインストールして下さい。
</p>

<br>
<h2 id="h02"><a name="container">コンテナの生成</a></h2>
<p>
　S2ContainerApplicationContext クラスの <a href="DIContainer.html#AppContainer">create メソッド</a>を使ってからっぽのコンテナを作ってみます。このサンプルは、s2container.php5/examples/quickstart/quickstart1 にあります。
</p>

<p>　　quickstart.php</p>
<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

$container = S2ContainerApplicationContext::create();
$container->getComponentDefSize() == 0 ?
    print 'コンテナはからっぽです。' :
    print 'コンポーネントが入ってます。';
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
コンテナはからっぽです。
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="component">コンポーネントの生成</a></h2>
<p>
　コンテナが生成できたので、コンポーネントをインポートしてみます。このサンプルは s2container.php5/examples/quickstart/quickstart2 にあります。<br><br>
　カレントディレクトリに classes ディレクトリを作成して、Hello クラスを作ります。
</p>

<p>　　classes/Hello.class.php</p>
<pre>
&lt;?php
class Hello {
    public function sayHello() {
        print 'Hello World !' . PHP_EOL;
    }
}
?&gt;
</pre>

<p>
　quickstart.php で classes ディレクトリ以下のクラスファイルが Autoload されるように classes ディレクトリを <a href="DIContainer.html#AppImport">import</a> します。
</p>

<p>　　quickstart.php</p>
<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes');
$container = S2ContainerApplicationContext::create();
$container->getComponentDefSize() == 0 ?
    print 'コンテナはからっぽです。' :
    print 'コンポーネントが入ってます。';
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
コンポーネントが入ってます。
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="get-component">コンポーネントの取得</a></h2>
<p>
　「コンポーネントが入ってます。」と表示されたので、取り出してみます。このサンプルは s2container.php5/examples/quickstart/quickstart3 にあります。
</p>

<p>　　quickstart.php</p>
<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes');
$container = S2ContainerApplicationContext::create();
$container->getComponentDefSize() == 0 ?
    print 'コンテナはからっぽです。' :
    print 'コンポーネントが入ってます。';
$hello = $container->getComponent('Hello');
$hello->sayHello();
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
コンポーネントが入ってます。
Hello World !
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="many-component">複数のコンポーネントを扱ってみる</a></h2>
<p>
　classes ディレクトリに次のような Printer クラスを追加します。このサンプルは s2container.php5/examples/quickstart/quickstart4 にあります。
</p>

<p>　　classes/Printer.class.php</p>
<pre>
&lt;?php
class Printer {
    public function printOut($message) {
        print __METHOD__ . ' : ' . $message . PHP_EOL;
    }
?&gt;
</pre>

<p>
　quickstart.php を次のように編集して Printer コンポーネントを取り出してみます。
</p>

<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes');
$container = S2ContainerApplicationContext::create();
$hello = $container->getComponent('Hello');
$hello->sayHello();
$printer = $container-&gt;getComponent('Printer');
$printer->printOut('Hello World !');
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
Hello World !
Printer::printOut : Hello World !
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="di">DI してみる</a></h2>
<p>
　2つのコンポーネントが作成できたので、Hello コンポーネントに Printer コンポーネントを DI ( Dependency Injection) してみます。このサンプルは s2container.php5/examples/quickstart/quickstart5 にあります。
<br>
Hello クラスに Printer インスタンスを受け取るセッターメソッドを追加します。また、sayHelloメソッドでPrinter クラスを用いて
出力するように変更します。
</p>

<p>　　classes/Hello.class.php</p>
<pre>
&lt;?php
class Hello {
    private $printer;
    public function setPrinter(Printer $printer) {
        $this-&gt;printer = $printer;
    }
    public function sayHello() {
        $this-&gt;printer-&gt;printOut('Hello World ! with DI');
    }
}
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
Printer::printOut : Hello World ! with DI
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="aspect">アスペクトしてみる</a></h2>
<p>
　S2Container に付属の TraceInterceptor を Printer クラスの printOut メソッドにアスペクトしてみます。このサンプルは s2container.php5/examples/quickstart/quickstart6 にあります。 <br><br>
アスペクト設定は、
<a href="DIContainer.html#AppAnnotation">@S2Aspect アノテーション</a>で行います。次のように printOut メソッドにアノテーションを記述します。
</p>

<p>　　classes/Printer.class.php</p>
<pre>
&lt;?php
class Printer {
    /**
     * @S2Aspect('interceptor' =&gt; 'new S2Container_TraceInterceptor');
     */
    public function printOut($message) {
        print __METHOD__ . ' : ' . $message . PHP_EOL;
    }
}
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
BEGIN Printer#printOut(Hello World ! with DI)
Printer::printOut : Hello World ! with DI
END   Printer#printOut(Hello World ! with DI) : null
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="autoaspect">自動アスペクト</a></h2>
<p>
　<a href="DIContainer.html#AppAutoAspect">S2ContainerApplicationContext クラスの registerAspect メソッドを用いて自動アスペクト</a>を行います。このサンプルは s2container.php5/examples/quickstart/quickstart7 にあります。 <br><br>

<a href="#aspect">アスペクトしてみる</a>で Printer クラスに記述した
<a href="DIContainer.html#AppAnnotation">@S2Aspect アノテーション</a>を削除します。
</p>

<p>　　classes/Printer.class.php</p>
<pre>
&lt;?php
class Printer {
    public function printOut($message) {
        print __METHOD__ . ' : ' . $message . PHP_EOL;
    }
}
?&gt;
</pre>

<p>
　quickstart.php を次のように編集します。
</p>

<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes');
S2ContainerApplicationContext::registerAspect('/Printer$/', 'new S2Container_TraceInterceptor', 'printOut');
$container = S2ContainerApplicationContext::create();
$hello = $container->getComponent('Hello');
$hello->sayHello();
?&gt;
</pre>

<p>
　実行してみます。
</p>

<pre>
% php quickstart.php
BEGIN Printer#printOut(Hello World ! with DI)
Printer::printOut : Hello World ! with DI
END   Printer#printOut(Hello World ! with DI) : null
%
</pre>

</div>

<br>
<div class="section">
<h2 id="h02"><a name="dicon">DICON ファイルを使用する場合</a></h2>
<p>
　これまでの作業をダイコンファイルに記述すると次のようになります。カレントディレクトリに
dicon ディレクトリを作成して hello.dicon として保存します。このサンプルは s2container.php5/examples/quickstart/quickstart8 にあります。
</p>

<p>　　dicon/hello.dicon</p>
<pre>
&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR//DTD S2Container//EN" "components21.dtd"&gt;
&lt;components&gt;
    &lt;component class="Hello"&gt;
        &lt;property name="printer"&gt;Printer&lt;/property&gt;
    &lt;/component&gt;
    &lt;component class="Printer"&gt;
        &lt;aspect pointcut="printOut"&gt;new S2Container_TraceInterceptor&lt;/aspect&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>

<p>
　このダイコンファイルを使用するかたちに quickstart.php を編集します。<a href="DIContainer.html#AppComponent">setIncludePattern メソッド</a>でダイコンファイルを Include Pattern に設定します。
</p>

<pre>
&lt;?php
require_once('S2Container/S2Container.php');
require_once('S2ContainerSplAutoLoad.php');

S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'classes');
S2ContainerApplicationContext::import(dirname(__FILE__) . DIRECTORY_SEPARATOR . 'dicon');
S2ContainerApplicationContext::setIncludePattern('/hello.dicon$/');
$container = S2ContainerApplicationContext::create();
$hello = $container-&gt;getComponent('Hello');
$hello-&gt;sayHello();
?&gt;
</pre>

<p>
　実行すると同様の結果が表示されます。
</p>

<pre>
% php quickstart.php
BEGIN Printer#printOut(Hello World ! with DI)
Printer::printOut : Hello World ! with DI
END   Printer#printOut(Hello World ! with DI) : null
%
</pre>

</div>


</div><!-- article -->
</div><!-- contents_center -->

<div id="footer">
<address>&#169; Copyright The Seasar Foundation and the others 2005-2007, all rights reserved.</address>
<div class="line"><span class="hide">spacer</span></div>
</div><!-- footer -->

</div><!-- wrapper -->

</body></html>