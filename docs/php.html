<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ja" lang="ja"><head>



<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Language" content="ja">
<meta http-equiv="Content-Style-Type" content="text/css">
<meta name="keywords" content="Seasar2, S2Container, DI, AOP, Dependency Injection, Aspect Oriented Programming, The Seasar Foundation, OSS, オープンソースソフトウェア, Java, フレームワーク">
<meta name="description" content="私たちSeasarプロジェクトはオープンソースという仕組みの元、開発者のゆとりを実現できるプロダクトの開発と提供を通じて、ユーザと開発者とが共に喜びを分かち合える環境実現をお手伝いすることを目指し活動しています。 ">
<title>The Seasar Project - S2Container.PHP5</title>

<link rel="stylesheet" type="text/css" href="theme/main.css" media="screen,projection">
<link rel="stylesheet" type="text/css" href="theme/print.css" media="print"></head><body>

<div id="wrapper">

<div id="header">

<div class="line"><span class="hide">spacer</span></div>

<div id="logo">
<h1 id="h01" class="hide">The Seasar Project</h1>
<a href="http://www.seasar.org/">
<img src="images/seasar_logo_blue.gif" alt="The Seasar Project" height="180" width="390">
</a>
</div>

<div id="tool">
</div>

<div id="navi">
<p><font size="-1"><a href="index.html">S2Container.PHP5 ホーム</a> &raquo; ドキュメント &raquo; PHP式</font></p>
</div>

</div><!-- header -->

<div id="contents_left">

<h2>メニュー</h2>

<h3>ドキュメント</h3>
<ul>
    <li><a href="setup.html">セットアップ</a></li>
    <li><a href="quickstart.html">クイックスタート</a></li>
    <li><a href="DIContainer.html">DIContainer</a></li>
    <li><a href="aop.html">AOP</a></li>
    <li><a href="extension.html">Extension</a></li>
    <li>PHP式
        <font size="-2">
        <ul>
            <li><a href="#about">PHP式について</a>
            <li><a href="#arg">arg、property、aspect、metaタグ</a></li>
            <li><a href="#compoonent">componentタグ</a></li>
            <li><a href="#method">initMethod、destroyMethodタグ</a></li>
        </ul>
        </font>
    </li>
</ul>

<h3>リンク</h3>
<ul>
    <li><a href="http://www.seasar.org/">Seasar.org</a></li>
    <li><a href="http://svn.seasar.org/browse/?root=s2container.php5">SVN リポジトリブラウザ</a></li>
    <li><a href="https://www.seasar.org/svn/s2container.php5/">SVN リポジトリ</a></li>
    <li><a href="https://www.seasar.org/issues/browse/CONTAINERPHP">Issue Tracker</a></li>
    <li><a href="http://labs.s2php5.jp/">labs.s2php5.jp</a></li>
</ul>

<h2>PHP プロジェクト</h2>

<h3>Seasar.PHP</h3>

<ul>
    <li><a href="http://s2container.php5.seasar.org/">S2Container.PHP5</a></li>
    <li><a href="http://s2dao.php5.seasar.org/">S2Dao.PHP5</a></li>
</ul>

<h3>Sandbox.PHP</h3>

<ul>
    <li><a href="http://s2ana.php5.sandbox.seasar.org/">S2AnA.PHP5</a></li>
    <li><a href="http://kunit.jp/maple/">Maple.PHP</a></li>
    <li><a href="http://s2base.php5.sandbox.seasar.org/">S2Base.PHP5</a></li>
</ul>



</div><!-- contents_left -->

<div id="contents_center">

<div id="article">
<div class="section">
<h2 id="h02"><a name="about">PHP式について</a></h2>

<p>
　PHP式とは、Seasar2のdiconファイルに記述するPHPソースを指します。
diconファイルの&lt;property&gt;要素の他，
&lt;component&gt;要素・&lt;initMethod&gt;要素・&lt;destroyMethod&gt;要素・&lt;arg&gt;要素・
&lt;meta&gt;要素・&lt;aspect&gt;要素にPHP式を記述することができます。<br>
本説明に用いるdiconファイルを使用したサンプルは、s2container.php5/examples/dicon/expression にあります。
</p>

</div>
<br>

<div class="section">
<h2 id="h02"><a name="arg">arg、property、aspect、metaタグ</a></h2>

<p>
　コンストラクタ引数やプロパティに設定したい値を返すPHP式を記述します。
</p>

<pre>&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="sample1" class="ArgExp"&gt;
        &lt;arg&gt;10&lt;/arg&gt;
        &lt;property name="message"&gt;
            file_get_contents(EXAMPLE_DIR . '/dicon/expression/ArgSample.txt')
        &lt;/property&gt;
    &lt;/component&gt;
    &lt;component name="sample2" class="ArgExp"&gt;
        &lt;arg>2+3&lt;/arg&gt;
        &lt;property name="message"&gt;&lt;![CDATA[
            $msg1 = "Hello ";
            $msg2 = "World";
            return $msg1 . $msg2;
        ]]&gt;&lt;/property&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>
PHP式が return を含まない場合は、自動的に return が付加されます。コンポーネント sample1 では、<br>
コンストラクタ引数は以下の式がeval関数で処理されます。
<pre> return 10; </pre>
messageプロパティは以下の式がeval関数で処理されます。
<pre> return file_get_contents(EXAMPLE_DIR . '/dicon/expression/ArgSample.txt');</pre>
aspectタグやmetaタグにも同様にPHP式を記述できます。

</div>
<br>

<div class="section">
<h2 id="h02"><a name="compoonent">componentタグ</a></h2>

<p>
　オブジェクトを返すPHP式を記述します。
</p>

<pre>&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="hello"&gt;
       new ComponentExp("Hello")
        &lt;property name="messageB"&gt;"World"&lt;/property&gt;
    &lt;/component&gt;
    &lt;component name="hello2" class="ComponentExp"&gt;
        hello3
    &lt;/component&gt;
    &lt;component name="hello3" class="ComponentExp"/&gt;
&lt;/components&gt;
</pre>

componentタグのクラス属性が指定されている場合は、PHP式で返されたオブジェクトと
ReflectionClass#isSubclassOf 比較を行います。

</div>

<br>

<div class="section">
<h2 id="h02"><a name="method">initMethod、destroyMethodタグ</a></h2>
<p>
　コンポーネントの初期化、終了時の処理をPHP式で記述します。$component変数により自身を参照できます。
</p>

<pre>&lt;?xml version="1.0" encoding="Shift_JIS"?&gt;
&lt;!DOCTYPE components PUBLIC "-//SEASAR2.1//DTD S2Container//EN"
"http://www.seasar.org/dtd/components21.dtd"&gt;
&lt;components&gt;
    &lt;component name="method" class="MethodExp"&gt;
        &lt;initMethod&gt;
            $component->init(10)
        &lt;/initMethod&gt;
    &lt;/component&gt;
&lt;/components&gt;
</pre>


</div>
</div><!-- article -->

</div><!-- contents_center -->

<div id="footer">
<address>&#169; Copyright The Seasar Foundation and the others 2005-2007, all rights reserved.</address>
<div class="line"><span class="hide">spacer</span></div>
</div><!-- footer -->

</div><!-- wrapper -->

</body></html>